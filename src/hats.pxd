cpdef double hat(double x, size_t i_, size_t n_) except *
cpdef double hat_dot_pow3(double x, double[:] w, size_t n) except *
cpdef size_t idx_ct_4hats(size_t i, size_t j, size_t k, size_t m, size_t n, bint check) except *